<?php

$datalist = array(

  array('mainid' => 10082107,'maintype' => '単行本','subid' => 173112,'subtype' => '電子書籍'),
  array('mainid' => 10082108,'maintype' => '単行本','subid' => 173114,'subtype' => '電子書籍'),
  array('mainid' => 10082109,'maintype' => '単行本','subid' => 173115,'subtype' => '電子書籍'),
  array('mainid' => 10082110,'maintype' => '単行本','subid' => 173116,'subtype' => '電子書籍'),
  array('mainid' => 10082111,'maintype' => '単行本','subid' => 173274,'subtype' => '電子書籍'),
  array('mainid' => 10082112,'maintype' => '単行本','subid' => 175011,'subtype' => '電子書籍'),
  array('mainid' => 10082113,'maintype' => '単行本','subid' => 175022,'subtype' => '電子書籍'),
  array('mainid' => 10082114,'maintype' => '単行本','subid' => 175040,'subtype' => '電子書籍'),
  array('mainid' => 10082115,'maintype' => '単行本','subid' => 175042,'subtype' => '電子書籍'),
  array('mainid' => 10082116,'maintype' => '単行本','subid' => 175047,'subtype' => '電子書籍'),
  array('mainid' => 10082117,'maintype' => '単行本','subid' => 175048,'subtype' => '電子書籍'),
  array('mainid' => 10082118,'maintype' => '単行本','subid' => 175054,'subtype' => '電子書籍'),
  array('mainid' => 10082119,'maintype' => '単行本','subid' => 175103,'subtype' => '電子書籍'),
  array('mainid' => 10082120,'maintype' => '単行本','subid' => 175104,'subtype' => '電子書籍'),
  array('mainid' => 10082121,'maintype' => '単行本','subid' => 175106,'subtype' => '電子書籍'),
  array('mainid' => 10082122,'maintype' => '単行本','subid' => 175122,'subtype' => '電子書籍'),
  array('mainid' => 10082123,'maintype' => '単行本','subid' => 175270,'subtype' => '電子書籍'),
  array('mainid' => 10082124,'maintype' => '単行本','subid' => 175310,'subtype' => '電子書籍'),
  array('mainid' => 10082125,'maintype' => '単行本','subid' => 175311,'subtype' => '電子書籍'),
  array('mainid' => 10082126,'maintype' => '単行本','subid' => 175332,'subtype' => '電子書籍'),
  array('mainid' => 10082127,'maintype' => '単行本','subid' => 175333,'subtype' => '電子書籍'),
  array('mainid' => 10082128,'maintype' => '単行本','subid' => 175389,'subtype' => '電子書籍'),
  array('mainid' => 10082129,'maintype' => '単行本','subid' => 175441,'subtype' => '電子書籍'),
  array('mainid' => 10082130,'maintype' => '単行本','subid' => 175442,'subtype' => '電子書籍'),
  array('mainid' => 10082131,'maintype' => '単行本','subid' => 175462,'subtype' => '電子書籍'),
  array('mainid' => 10082132,'maintype' => '単行本','subid' => 175463,'subtype' => '電子書籍'),
  array('mainid' => 10082133,'maintype' => '単行本','subid' => 175526,'subtype' => '電子書籍'),
  array('mainid' => 10082134,'maintype' => '単行本','subid' => 175527,'subtype' => '電子書籍'),
  array('mainid' => 10082135,'maintype' => '単行本','subid' => 175531,'subtype' => '電子書籍'),
  array('mainid' => 10082136,'maintype' => '単行本','subid' => 175532,'subtype' => '電子書籍'),
  array('mainid' => 10082137,'maintype' => '単行本','subid' => 175547,'subtype' => '電子書籍'),
  array('mainid' => 10082138,'maintype' => '単行本','subid' => 175550,'subtype' => '電子書籍'),
  array('mainid' => 10082139,'maintype' => '単行本','subid' => 175554,'subtype' => '電子書籍'),
  array('mainid' => 10082140,'maintype' => '単行本','subid' => 175559,'subtype' => '電子書籍'),
  array('mainid' => 10082141,'maintype' => '単行本','subid' => 175564,'subtype' => '電子書籍'),
  array('mainid' => 10082142,'maintype' => '単行本','subid' => 175567,'subtype' => '電子書籍'),
  array('mainid' => 10082143,'maintype' => '単行本','subid' => 175568,'subtype' => '電子書籍'),
  array('mainid' => 10082144,'maintype' => '単行本','subid' => 175571,'subtype' => '電子書籍'),
  array('mainid' => 10082145,'maintype' => '単行本','subid' => 176020,'subtype' => '電子書籍'),
  array('mainid' => 10082146,'maintype' => '単行本','subid' => 176036,'subtype' => '電子書籍'),
  array('mainid' => 10082147,'maintype' => '単行本','subid' => 176037,'subtype' => '電子書籍'),
  array('mainid' => 10082148,'maintype' => '単行本','subid' => 181983,'subtype' => '電子書籍'),
  array('mainid' => 10082149,'maintype' => '単行本','subid' => 182409,'subtype' => '電子書籍'),
  array('mainid' => 10082150,'maintype' => '単行本','subid' => 183535,'subtype' => '電子書籍'),
  array('mainid' => 10082151,'maintype' => '単行本','subid' => 190455,'subtype' => '電子書籍'),
  array('mainid' => 10082152,'maintype' => '単行本','subid' => 193371,'subtype' => '電子書籍'),
  array('mainid' => 10082153,'maintype' => '単行本','subid' => 193966,'subtype' => '電子書籍'),
  array('mainid' => 10082154,'maintype' => '単行本','subid' => 196075,'subtype' => '電子書籍'),
  array('mainid' => 10082155,'maintype' => '単行本','subid' => 201283,'subtype' => '電子書籍'),
  array('mainid' => 10082156,'maintype' => '単行本','subid' => 207630,'subtype' => '電子書籍'),
  array('mainid' => 10082157,'maintype' => '単行本','subid' => 212829,'subtype' => '電子書籍'),
  array('mainid' => 10082158,'maintype' => '単行本','subid' => 214603,'subtype' => '電子書籍'),
  array('mainid' => 10082159,'maintype' => '単行本','subid' => 215985,'subtype' => '電子書籍'),
  array('mainid' => 10082160,'maintype' => '単行本','subid' => 219796,'subtype' => '電子書籍'),
  array('mainid' => 10082161,'maintype' => '単行本','subid' => 222424,'subtype' => '電子書籍'),
  array('mainid' => 10082162,'maintype' => '単行本','subid' => 222425,'subtype' => '電子書籍'),
  array('mainid' => 10082163,'maintype' => '単行本','subid' => 222466,'subtype' => '電子書籍'),
  array('mainid' => 10082164,'maintype' => '単行本','subid' => 227295,'subtype' => '電子書籍'),
  array('mainid' => 10082165,'maintype' => '単行本','subid' => 227328,'subtype' => '電子書籍'),
  array('mainid' => 10082166,'maintype' => '単行本','subid' => 227400,'subtype' => '電子書籍'),
  array('mainid' => 10082167,'maintype' => '単行本','subid' => 238167,'subtype' => '電子書籍'),
  array('mainid' => 10082168,'maintype' => '単行本','subid' => 238529,'subtype' => '電子書籍'),
  array('mainid' => 10082169,'maintype' => '単行本','subid' => 238530,'subtype' => '電子書籍'),
  array('mainid' => 10082170,'maintype' => '単行本','subid' => 239921,'subtype' => '電子書籍'),
  array('mainid' => 10082171,'maintype' => '単行本','subid' => 239922,'subtype' => '電子書籍'),
  array('mainid' => 10082172,'maintype' => '単行本','subid' => 244167,'subtype' => '電子書籍'),
  array('mainid' => 10082173,'maintype' => '単行本','subid' => 244379,'subtype' => '電子書籍'),
  array('mainid' => 10082174,'maintype' => '単行本','subid' => 245528,'subtype' => '電子書籍'),
  array('mainid' => 10082175,'maintype' => '単行本','subid' => 245529,'subtype' => '電子書籍'),
  array('mainid' => 10082176,'maintype' => '単行本','subid' => 251268,'subtype' => '電子書籍'),
  array('mainid' => 10081742,'maintype' => '単行本','subid' => 253099,'subtype' => '電子書籍'),
  array('mainid' => 10081743,'maintype' => '単行本','subid' => 272826,'subtype' => '電子書籍'),
  array('mainid' => 10081744,'maintype' => '単行本','subid' => 276650,'subtype' => '電子書籍'),
  array('mainid' => 10082180,'maintype' => '単行本','subid' => 276653,'subtype' => '電子書籍'),
  array('mainid' => 10082181,'maintype' => '単行本','subid' => 279396,'subtype' => '電子書籍'),
  array('mainid' => 10081747,'maintype' => '単行本','subid' => 280889,'subtype' => '電子書籍'),
  array('mainid' => 10081748,'maintype' => '単行本','subid' => 281087,'subtype' => '電子書籍'),
  array('mainid' => 10082184,'maintype' => '単行本','subid' => 281823,'subtype' => '電子書籍'),
  array('mainid' => 10082185,'maintype' => '単行本','subid' => 283081,'subtype' => '電子書籍'),
  array('mainid' => 10082186,'maintype' => '単行本','subid' => 283082,'subtype' => '電子書籍'),
  array('mainid' => 10081752,'maintype' => '単行本','subid' => 285616,'subtype' => '電子書籍'),
  array('mainid' => 10082188,'maintype' => '単行本','subid' => 285685,'subtype' => '電子書籍'),
  array('mainid' => 10082189,'maintype' => '単行本','subid' => 286771,'subtype' => '電子書籍'),
  array('mainid' => 10082190,'maintype' => '単行本','subid' => 297732,'subtype' => '電子書籍'),
  array('mainid' => 10082191,'maintype' => '単行本','subid' => 297734,'subtype' => '電子書籍'),
  array('mainid' => 10081757,'maintype' => '単行本','subid' => 307759,'subtype' => '電子書籍'),
  array('mainid' => 10082193,'maintype' => '単行本','subid' => 307764,'subtype' => '電子書籍'),
  array('mainid' => 10082194,'maintype' => '単行本','subid' => 307947,'subtype' => '電子書籍'),
  array('mainid' => 10082195,'maintype' => '単行本','subid' => 309228,'subtype' => '電子書籍'),
  array('mainid' => 10082196,'maintype' => '単行本','subid' => 313389,'subtype' => '電子書籍'),
  array('mainid' => 10082197,'maintype' => '単行本','subid' => 314301,'subtype' => '電子書籍'),
  array('mainid' => 10082198,'maintype' => '単行本','subid' => 314320,'subtype' => '電子書籍'),
  array('mainid' => 10082199,'maintype' => '単行本','subid' => 333397,'subtype' => '電子書籍'),
  array('mainid' => 10082200,'maintype' => '単行本','subid' => 352542,'subtype' => '電子書籍'),
  array('mainid' => 10082201,'maintype' => '単行本','subid' => 353276,'subtype' => '電子書籍'),
  array('mainid' => 10081767,'maintype' => '単行本','subid' => 355720,'subtype' => '電子書籍'),
  array('mainid' => 10082203,'maintype' => '単行本','subid' => 355721,'subtype' => '電子書籍'),
  array('mainid' => 10081769,'maintype' => '単行本','subid' => 356808,'subtype' => '電子書籍'),
  array('mainid' => 10082205,'maintype' => '単行本','subid' => 357419,'subtype' => '電子書籍'),
  array('mainid' => 10082206,'maintype' => '単行本','subid' => 358892,'subtype' => '電子書籍'),
  array('mainid' => 10082207,'maintype' => '単行本','subid' => 360870,'subtype' => '電子書籍'),
  array('mainid' => 10081773,'maintype' => '単行本','subid' => 366804,'subtype' => '電子書籍'),
  array('mainid' => 10082209,'maintype' => '単行本','subid' => 366805,'subtype' => '電子書籍'),
  array('mainid' => 10081775,'maintype' => '単行本','subid' => 370546,'subtype' => '電子書籍'),
  array('mainid' => 10082211,'maintype' => '単行本','subid' => 370547,'subtype' => '電子書籍'),
  array('mainid' => 10081777,'maintype' => '単行本','subid' => 370550,'subtype' => '電子書籍'),
  array('mainid' => 10082213,'maintype' => '単行本','subid' => 370553,'subtype' => '電子書籍'),
  array('mainid' => 10081779,'maintype' => '単行本','subid' => 370554,'subtype' => '電子書籍'),
  array('mainid' => 10082215,'maintype' => '単行本','subid' => 372987,'subtype' => '電子書籍'),
  array('mainid' => 10082216,'maintype' => '単行本','subid' => 373802,'subtype' => '電子書籍'),
  array('mainid' => 10082217,'maintype' => '単行本','subid' => 373810,'subtype' => '電子書籍'),
  array('mainid' => 10082218,'maintype' => '単行本','subid' => 373811,'subtype' => '電子書籍'),
  array('mainid' => 10082219,'maintype' => '単行本','subid' => 375935,'subtype' => '電子書籍'),
  array('mainid' => 10082220,'maintype' => '単行本','subid' => 375937,'subtype' => '電子書籍'),
  array('mainid' => 10082221,'maintype' => '単行本','subid' => 375944,'subtype' => '電子書籍'),
  array('mainid' => 10082222,'maintype' => '単行本','subid' => 376058,'subtype' => '電子書籍'),
  array('mainid' => 10081788,'maintype' => '単行本','subid' => 377043,'subtype' => '電子書籍'),
  array('mainid' => 10081789,'maintype' => '単行本','subid' => 377399,'subtype' => '電子書籍'),
  array('mainid' => 10082225,'maintype' => '単行本','subid' => 378443,'subtype' => '電子書籍'),
  array('mainid' => 10082226,'maintype' => '単行本','subid' => 383153,'subtype' => '電子書籍'),
  array('mainid' => 10082227,'maintype' => '単行本','subid' => 427622,'subtype' => '電子書籍'),
  array('mainid' => 10082228,'maintype' => '単行本','subid' => 427623,'subtype' => '電子書籍'),
  array('mainid' => 10082229,'maintype' => '単行本','subid' => 432178,'subtype' => '電子書籍'),
  array('mainid' => 10082230,'maintype' => '単行本','subid' => 433126,'subtype' => '電子書籍'),
  array('mainid' => 10082231,'maintype' => '単行本','subid' => 433128,'subtype' => '電子書籍'),
  array('mainid' => 10082232,'maintype' => '単行本','subid' => 437615,'subtype' => '電子書籍'),
  array('mainid' => 10082233,'maintype' => '単行本','subid' => 437616,'subtype' => '電子書籍'),
  array('mainid' => 10082234,'maintype' => '単行本','subid' => 437618,'subtype' => '電子書籍'),
  array('mainid' => 10082235,'maintype' => '単行本','subid' => 439188,'subtype' => '電子書籍'),
  array('mainid' => 10082236,'maintype' => '単行本','subid' => 439330,'subtype' => '電子書籍'),
  array('mainid' => 10082237,'maintype' => '単行本','subid' => 439331,'subtype' => '電子書籍'),
  array('mainid' => 10082238,'maintype' => '単行本','subid' => 439599,'subtype' => '電子書籍'),
  array('mainid' => 10082239,'maintype' => '単行本','subid' => 441074,'subtype' => '電子書籍'),
  array('mainid' => 10082240,'maintype' => '単行本','subid' => 441086,'subtype' => '電子書籍'),
  array('mainid' => 10082241,'maintype' => '単行本','subid' => 449082,'subtype' => '電子書籍'),
  array('mainid' => 10082242,'maintype' => '単行本','subid' => 450491,'subtype' => '電子書籍'),
  array('mainid' => 10082243,'maintype' => '単行本','subid' => 452285,'subtype' => '電子書籍'),
  array('mainid' => 10082244,'maintype' => '単行本','subid' => 452286,'subtype' => '電子書籍'),
  array('mainid' => 10082245,'maintype' => '単行本','subid' => 452287,'subtype' => '電子書籍'),
  array('mainid' => 10081811,'maintype' => '単行本','subid' => 452288,'subtype' => '電子書籍'),
  array('mainid' => 10082247,'maintype' => '単行本','subid' => 452295,'subtype' => '電子書籍'),
  array('mainid' => 10082248,'maintype' => '単行本','subid' => 452297,'subtype' => '電子書籍'),
  array('mainid' => 10082249,'maintype' => '単行本','subid' => 454667,'subtype' => '電子書籍'),
  array('mainid' => 10082250,'maintype' => '単行本','subid' => 457748,'subtype' => '電子書籍'),
  array('mainid' => 10082251,'maintype' => '単行本','subid' => 457749,'subtype' => '電子書籍'),
  array('mainid' => 10082252,'maintype' => '単行本','subid' => 457750,'subtype' => '電子書籍'),
  array('mainid' => 10082253,'maintype' => '単行本','subid' => 468285,'subtype' => '電子書籍'),
  array('mainid' => 10082254,'maintype' => '単行本','subid' => 470584,'subtype' => '電子書籍'),
  array('mainid' => 10082255,'maintype' => '単行本','subid' => 470585,'subtype' => '電子書籍'),
  array('mainid' => 10082256,'maintype' => '単行本','subid' => 470589,'subtype' => '電子書籍'),
  array('mainid' => 10082257,'maintype' => '単行本','subid' => 470593,'subtype' => '電子書籍'),
  array('mainid' => 10082258,'maintype' => '単行本','subid' => 470595,'subtype' => '電子書籍'),
  array('mainid' => 10082259,'maintype' => '単行本','subid' => 471398,'subtype' => '電子書籍'),
  array('mainid' => 10082260,'maintype' => '単行本','subid' => 471919,'subtype' => '電子書籍'),
  array('mainid' => 10082261,'maintype' => '単行本','subid' => 471930,'subtype' => '電子書籍'),
  array('mainid' => 10082262,'maintype' => '単行本','subid' => 472232,'subtype' => '電子書籍'),
  array('mainid' => 10082263,'maintype' => '単行本','subid' => 472234,'subtype' => '電子書籍'),
  array('mainid' => 10082264,'maintype' => '単行本','subid' => 475116,'subtype' => '電子書籍'),
  array('mainid' => 10081830,'maintype' => '単行本','subid' => 477885,'subtype' => '電子書籍'),
  array('mainid' => 10082266,'maintype' => '単行本','subid' => 477889,'subtype' => '電子書籍'),
  array('mainid' => 10082267,'maintype' => '単行本','subid' => 477892,'subtype' => '電子書籍'),
  array('mainid' => 10081833,'maintype' => '単行本','subid' => 477897,'subtype' => '電子書籍'),
  array('mainid' => 10082269,'maintype' => '単行本','subid' => 477898,'subtype' => '電子書籍'),
  array('mainid' => 10082270,'maintype' => '単行本','subid' => 477908,'subtype' => '電子書籍'),
  array('mainid' => 10081836,'maintype' => '単行本','subid' => 480793,'subtype' => '電子書籍'),
  array('mainid' => 10082272,'maintype' => '単行本','subid' => 481178,'subtype' => '電子書籍'),
  array('mainid' => 10082273,'maintype' => '単行本','subid' => 482160,'subtype' => '電子書籍'),
  array('mainid' => 10082274,'maintype' => '単行本','subid' => 482163,'subtype' => '電子書籍'),
  array('mainid' => 10082275,'maintype' => '単行本','subid' => 487523,'subtype' => '電子書籍'),
  array('mainid' => 10082276,'maintype' => '単行本','subid' => 487604,'subtype' => '電子書籍'),
  array('mainid' => 10082277,'maintype' => '単行本','subid' => 487606,'subtype' => '電子書籍'),
  array('mainid' => 10082278,'maintype' => '単行本','subid' => 496803,'subtype' => '電子書籍'),
  array('mainid' => 10082279,'maintype' => '単行本','subid' => 496806,'subtype' => '電子書籍'),
  array('mainid' => 10082280,'maintype' => '単行本','subid' => 496815,'subtype' => '電子書籍'),
  array('mainid' => 10082281,'maintype' => '単行本','subid' => 496817,'subtype' => '電子書籍'),
  array('mainid' => 10082282,'maintype' => '単行本','subid' => 496829,'subtype' => '電子書籍'),
  array('mainid' => 10082283,'maintype' => '単行本','subid' => 496830,'subtype' => '電子書籍'),
  array('mainid' => 10081849,'maintype' => '単行本','subid' => 497762,'subtype' => '電子書籍'),
  array('mainid' => 10082285,'maintype' => '単行本','subid' => 498051,'subtype' => '電子書籍'),
  array('mainid' => 10082286,'maintype' => '単行本','subid' => 498200,'subtype' => '電子書籍'),
  array('mainid' => 10082287,'maintype' => '単行本','subid' => 498217,'subtype' => '電子書籍'),
  array('mainid' => 10082288,'maintype' => '単行本','subid' => 498243,'subtype' => '電子書籍'),
  array('mainid' => 10082289,'maintype' => '単行本','subid' => 498244,'subtype' => '電子書籍'),
  array('mainid' => 10082290,'maintype' => '単行本','subid' => 498245,'subtype' => '電子書籍'),
  array('mainid' => 10082291,'maintype' => '単行本','subid' => 498744,'subtype' => '電子書籍'),
  array('mainid' => 10082292,'maintype' => '単行本','subid' => 498762,'subtype' => '電子書籍'),
  array('mainid' => 10082293,'maintype' => '単行本','subid' => 498765,'subtype' => '電子書籍'),
  array('mainid' => 10081859,'maintype' => '単行本','subid' => 498771,'subtype' => '電子書籍'),
  array('mainid' => 10082295,'maintype' => '単行本','subid' => 505933,'subtype' => '電子書籍'),
  array('mainid' => 10082296,'maintype' => '単行本','subid' => 507347,'subtype' => '電子書籍'),
  array('mainid' => 10082297,'maintype' => '単行本','subid' => 507364,'subtype' => '電子書籍'),
  array('mainid' => 10082298,'maintype' => '単行本','subid' => 507498,'subtype' => '電子書籍'),
  array('mainid' => 10082299,'maintype' => '単行本','subid' => 507500,'subtype' => '電子書籍'),
  array('mainid' => 10082300,'maintype' => '単行本','subid' => 507502,'subtype' => '電子書籍'),
  array('mainid' => 10082301,'maintype' => '単行本','subid' => 507503,'subtype' => '電子書籍'),
  array('mainid' => 10081867,'maintype' => '単行本','subid' => 508486,'subtype' => '電子書籍'),
  array('mainid' => 10082303,'maintype' => '単行本','subid' => 510854,'subtype' => '電子書籍'),
  array('mainid' => 10082304,'maintype' => '単行本','subid' => 510857,'subtype' => '電子書籍'),
  array('mainid' => 10082305,'maintype' => '単行本','subid' => 510861,'subtype' => '電子書籍'),
  array('mainid' => 10082306,'maintype' => '単行本','subid' => 511171,'subtype' => '電子書籍'),
  array('mainid' => 10082307,'maintype' => '単行本','subid' => 512440,'subtype' => '電子書籍'),
  array('mainid' => 10082308,'maintype' => '単行本','subid' => 512549,'subtype' => '電子書籍'),
  array('mainid' => 10082309,'maintype' => '単行本','subid' => 512552,'subtype' => '電子書籍'),
  array('mainid' => 10082310,'maintype' => '単行本','subid' => 512553,'subtype' => '電子書籍'),
  array('mainid' => 10082311,'maintype' => '単行本','subid' => 516583,'subtype' => '電子書籍'),
  array('mainid' => 10082312,'maintype' => '単行本','subid' => 516584,'subtype' => '電子書籍'),
  array('mainid' => 10082313,'maintype' => '単行本','subid' => 524483,'subtype' => '電子書籍'),
  array('mainid' => 10082314,'maintype' => '単行本','subid' => 524484,'subtype' => '電子書籍'),
  array('mainid' => 10082315,'maintype' => '単行本','subid' => 524596,'subtype' => '電子書籍'),
  array('mainid' => 10082316,'maintype' => '単行本','subid' => 525055,'subtype' => '電子書籍'),
  array('mainid' => 10082317,'maintype' => '単行本','subid' => 525056,'subtype' => '電子書籍'),
  array('mainid' => 10081883,'maintype' => '単行本','subid' => 525057,'subtype' => '電子書籍'),
  array('mainid' => 10082319,'maintype' => '単行本','subid' => 525058,'subtype' => '電子書籍'),
  array('mainid' => 10082320,'maintype' => '単行本','subid' => 525059,'subtype' => '電子書籍'),
  array('mainid' => 10082321,'maintype' => '単行本','subid' => 525061,'subtype' => '電子書籍'),
  array('mainid' => 10082322,'maintype' => '単行本','subid' => 525062,'subtype' => '電子書籍'),
  array('mainid' => 10082323,'maintype' => '単行本','subid' => 531249,'subtype' => '電子書籍'),
  array('mainid' => 10082324,'maintype' => '単行本','subid' => 531251,'subtype' => '電子書籍'),
  array('mainid' => 10082325,'maintype' => '単行本','subid' => 531252,'subtype' => '電子書籍'),
  array('mainid' => 10082326,'maintype' => '単行本','subid' => 535948,'subtype' => '電子書籍'),
  array('mainid' => 10082327,'maintype' => '単行本','subid' => 535995,'subtype' => '電子書籍'),
  array('mainid' => 10082328,'maintype' => '単行本','subid' => 548029,'subtype' => '電子書籍'),
  array('mainid' => 10082329,'maintype' => '単行本','subid' => 548038,'subtype' => '電子書籍'),
  array('mainid' => 10082330,'maintype' => '単行本','subid' => 552472,'subtype' => '電子書籍'),
  array('mainid' => 10082331,'maintype' => '単行本','subid' => 552533,'subtype' => '電子書籍'),
  array('mainid' => 10082332,'maintype' => '単行本','subid' => 555352,'subtype' => '電子書籍'),
  array('mainid' => 10082333,'maintype' => '単行本','subid' => 555356,'subtype' => '電子書籍'),
  array('mainid' => 10082334,'maintype' => '単行本','subid' => 555359,'subtype' => '電子書籍'),
  array('mainid' => 10082335,'maintype' => '単行本','subid' => 555367,'subtype' => '電子書籍'),
  array('mainid' => 10082336,'maintype' => '単行本','subid' => 555369,'subtype' => '電子書籍'),
  array('mainid' => 10082337,'maintype' => '単行本','subid' => 555374,'subtype' => '電子書籍'),
  array('mainid' => 10082338,'maintype' => '単行本','subid' => 555379,'subtype' => '電子書籍'),
  array('mainid' => 10082339,'maintype' => '単行本','subid' => 557900,'subtype' => '電子書籍'),
  array('mainid' => 10082340,'maintype' => '単行本','subid' => 559500,'subtype' => '電子書籍'),
  array('mainid' => 10082341,'maintype' => '単行本','subid' => 559501,'subtype' => '電子書籍'),
  array('mainid' => 10082342,'maintype' => '単行本','subid' => 559503,'subtype' => '電子書籍'),
  array('mainid' => 10081908,'maintype' => '単行本','subid' => 564164,'subtype' => '電子書籍'),
  array('mainid' => 10082344,'maintype' => '単行本','subid' => 564166,'subtype' => '電子書籍'),
  array('mainid' => 10082345,'maintype' => '単行本','subid' => 564172,'subtype' => '電子書籍'),
  array('mainid' => 10082346,'maintype' => '単行本','subid' => 564184,'subtype' => '電子書籍'),
  array('mainid' => 10082347,'maintype' => '単行本','subid' => 564190,'subtype' => '電子書籍'),
  array('mainid' => 10082348,'maintype' => '単行本','subid' => 564192,'subtype' => '電子書籍'),
  array('mainid' => 10082349,'maintype' => '単行本','subid' => 564785,'subtype' => '電子書籍'),
  array('mainid' => 10082350,'maintype' => '単行本','subid' => 564787,'subtype' => '電子書籍'),
  array('mainid' => 10082351,'maintype' => '単行本','subid' => 575172,'subtype' => '電子書籍'),
  array('mainid' => 10081917,'maintype' => '単行本','subid' => 575182,'subtype' => '電子書籍'),
  array('mainid' => 10082353,'maintype' => '単行本','subid' => 575186,'subtype' => '電子書籍'),
  array('mainid' => 10082354,'maintype' => '単行本','subid' => 582874,'subtype' => '電子書籍'),
  array('mainid' => 10082355,'maintype' => '単行本','subid' => 582875,'subtype' => '電子書籍'),
  array('mainid' => 10082356,'maintype' => '単行本','subid' => 584229,'subtype' => '電子書籍'),
  array('mainid' => 10082357,'maintype' => '単行本','subid' => 584231,'subtype' => '電子書籍'),
  array('mainid' => 10082358,'maintype' => '単行本','subid' => 584232,'subtype' => '電子書籍'),
  array('mainid' => 10081924,'maintype' => '単行本','subid' => 584384,'subtype' => '電子書籍'),
  array('mainid' => 10082360,'maintype' => '単行本','subid' => 587551,'subtype' => '電子書籍'),
  array('mainid' => 10082361,'maintype' => '単行本','subid' => 587556,'subtype' => '電子書籍'),
  array('mainid' => 10082362,'maintype' => '単行本','subid' => 587566,'subtype' => '電子書籍'),
  array('mainid' => 10082363,'maintype' => '単行本','subid' => 587572,'subtype' => '電子書籍'),
  array('mainid' => 10082364,'maintype' => '単行本','subid' => 587573,'subtype' => '電子書籍'),
  array('mainid' => 10082365,'maintype' => '単行本','subid' => 588611,'subtype' => '電子書籍'),
  array('mainid' => 10082366,'maintype' => '単行本','subid' => 590784,'subtype' => '電子書籍'),
  array('mainid' => 10081932,'maintype' => '単行本','subid' => 590785,'subtype' => '電子書籍'),
  array('mainid' => 10082368,'maintype' => '単行本','subid' => 590788,'subtype' => '電子書籍'),
  array('mainid' => 10082369,'maintype' => '単行本','subid' => 590792,'subtype' => '電子書籍'),
  array('mainid' => 10082370,'maintype' => '単行本','subid' => 590793,'subtype' => '電子書籍'),
  array('mainid' => 10082371,'maintype' => '単行本','subid' => 591045,'subtype' => '電子書籍'),
  array('mainid' => 10081937,'maintype' => '単行本','subid' => 591049,'subtype' => '電子書籍'),
  array('mainid' => 10082373,'maintype' => '単行本','subid' => 591051,'subtype' => '電子書籍'),
  array('mainid' => 10082374,'maintype' => '単行本','subid' => 592863,'subtype' => '電子書籍'),
  array('mainid' => 10082375,'maintype' => '単行本','subid' => 592864,'subtype' => '電子書籍'),
  array('mainid' => 10082376,'maintype' => '単行本','subid' => 594766,'subtype' => '電子書籍'),
  array('mainid' => 10082377,'maintype' => '単行本','subid' => 595099,'subtype' => '電子書籍'),
  array('mainid' => 10082378,'maintype' => '単行本','subid' => 596948,'subtype' => '電子書籍'),
  array('mainid' => 10082379,'maintype' => '単行本','subid' => 596949,'subtype' => '電子書籍'),
  array('mainid' => 10082380,'maintype' => '単行本','subid' => 596956,'subtype' => '電子書籍'),
  array('mainid' => 10082381,'maintype' => '単行本','subid' => 597177,'subtype' => '電子書籍'),
  array('mainid' => 10082382,'maintype' => '単行本','subid' => 597179,'subtype' => '電子書籍'),
  array('mainid' => 10081948,'maintype' => '単行本','subid' => 597182,'subtype' => '電子書籍'),
  array('mainid' => 10082384,'maintype' => '単行本','subid' => 599249,'subtype' => '電子書籍'),
  array('mainid' => 10082385,'maintype' => '単行本','subid' => 599269,'subtype' => '電子書籍'),
  array('mainid' => 10082386,'maintype' => '単行本','subid' => 599273,'subtype' => '電子書籍'),
  array('mainid' => 10082387,'maintype' => '単行本','subid' => 599279,'subtype' => '電子書籍'),
  array('mainid' => 10081953,'maintype' => '単行本','subid' => 599282,'subtype' => '電子書籍'),
  array('mainid' => 10082389,'maintype' => '単行本','subid' => 600280,'subtype' => '電子書籍'),
  array('mainid' => 10081955,'maintype' => '単行本','subid' => 600285,'subtype' => '電子書籍'),
  array('mainid' => 10082391,'maintype' => '単行本','subid' => 600286,'subtype' => '電子書籍'),
  array('mainid' => 10081957,'maintype' => '単行本','subid' => 600288,'subtype' => '電子書籍'),
  array('mainid' => 10082393,'maintype' => '単行本','subid' => 600289,'subtype' => '電子書籍'),
  array('mainid' => 10082394,'maintype' => '単行本','subid' => 600382,'subtype' => '電子書籍'),
  array('mainid' => 10082395,'maintype' => '単行本','subid' => 600388,'subtype' => '電子書籍'),
  array('mainid' => 10082396,'maintype' => '単行本','subid' => 601083,'subtype' => '電子書籍'),
  array('mainid' => 10082397,'maintype' => '単行本','subid' => 601084,'subtype' => '電子書籍'),
  array('mainid' => 10082398,'maintype' => '単行本','subid' => 601085,'subtype' => '電子書籍'),
  array('mainid' => 10081964,'maintype' => '単行本','subid' => 601088,'subtype' => '電子書籍'),
  array('mainid' => 10082400,'maintype' => '単行本','subid' => 601091,'subtype' => '電子書籍'),
  array('mainid' => 10082401,'maintype' => '単行本','subid' => 602834,'subtype' => '電子書籍'),
  array('mainid' => 10082402,'maintype' => '単行本','subid' => 602895,'subtype' => '電子書籍'),
  array('mainid' => 10082403,'maintype' => '単行本','subid' => 602901,'subtype' => '電子書籍'),
  array('mainid' => 10082404,'maintype' => '単行本','subid' => 602908,'subtype' => '電子書籍'),
  array('mainid' => 10082405,'maintype' => '単行本','subid' => 602967,'subtype' => '電子書籍'),
  array('mainid' => 10082406,'maintype' => '単行本','subid' => 603191,'subtype' => '電子書籍'),
  array('mainid' => 10081972,'maintype' => '単行本','subid' => 603196,'subtype' => '電子書籍'),
  array('mainid' => 10082408,'maintype' => '単行本','subid' => 603397,'subtype' => '電子書籍'),
  array('mainid' => 10082409,'maintype' => '単行本','subid' => 604635,'subtype' => '電子書籍'),
  array('mainid' => 10082410,'maintype' => '単行本','subid' => 606153,'subtype' => '電子書籍'),
  array('mainid' => 10082411,'maintype' => '単行本','subid' => 606162,'subtype' => '電子書籍'),
  array('mainid' => 10082412,'maintype' => '単行本','subid' => 607687,'subtype' => '電子書籍'),
  array('mainid' => 10082413,'maintype' => '単行本','subid' => 607688,'subtype' => '電子書籍'),
  array('mainid' => 10082414,'maintype' => '単行本','subid' => 607689,'subtype' => '電子書籍'),
  array('mainid' => 10082415,'maintype' => '単行本','subid' => 607690,'subtype' => '電子書籍'),
  array('mainid' => 10082416,'maintype' => '単行本','subid' => 609147,'subtype' => '電子書籍'),
  array('mainid' => 10082417,'maintype' => '単行本','subid' => 609148,'subtype' => '電子書籍'),
  array('mainid' => 10082418,'maintype' => '単行本','subid' => 609149,'subtype' => '電子書籍'),
  array('mainid' => 10082419,'maintype' => '単行本','subid' => 609154,'subtype' => '電子書籍'),
  array('mainid' => 10082420,'maintype' => '単行本','subid' => 610971,'subtype' => '電子書籍'),
  array('mainid' => 10082421,'maintype' => '単行本','subid' => 610990,'subtype' => '電子書籍'),
  array('mainid' => 10082422,'maintype' => '単行本','subid' => 610992,'subtype' => '電子書籍'),
  array('mainid' => 10082423,'maintype' => '単行本','subid' => 610994,'subtype' => '電子書籍'),
  array('mainid' => 10081989,'maintype' => '単行本','subid' => 611137,'subtype' => '電子書籍'),
  array('mainid' => 10082425,'maintype' => '単行本','subid' => 611138,'subtype' => '電子書籍'),
  array('mainid' => 10082426,'maintype' => '単行本','subid' => 612714,'subtype' => '電子書籍'),
  array('mainid' => 10082427,'maintype' => '単行本','subid' => 612952,'subtype' => '電子書籍'),
  array('mainid' => 10082428,'maintype' => '単行本','subid' => 612953,'subtype' => '電子書籍'),
  array('mainid' => 10082429,'maintype' => '単行本','subid' => 612954,'subtype' => '電子書籍'),
  array('mainid' => 10082430,'maintype' => '単行本','subid' => 612976,'subtype' => '電子書籍'),
  array('mainid' => 10082431,'maintype' => '単行本','subid' => 612979,'subtype' => '電子書籍'),
  array('mainid' => 10082432,'maintype' => '単行本','subid' => 612981,'subtype' => '電子書籍'),
  array('mainid' => 10082433,'maintype' => '単行本','subid' => 612983,'subtype' => '電子書籍'),
  array('mainid' => 10082434,'maintype' => '単行本','subid' => 612985,'subtype' => '電子書籍'),
  array('mainid' => 10082435,'maintype' => '単行本','subid' => 614410,'subtype' => '電子書籍'),
  array('mainid' => 10082436,'maintype' => '単行本','subid' => 614411,'subtype' => '電子書籍'),
  array('mainid' => 10082437,'maintype' => '単行本','subid' => 618251,'subtype' => '電子書籍'),
  array('mainid' => 10082438,'maintype' => '単行本','subid' => 618253,'subtype' => '電子書籍'),
  array('mainid' => 10082439,'maintype' => '単行本','subid' => 618255,'subtype' => '電子書籍'),
  array('mainid' => 10082440,'maintype' => '単行本','subid' => 619659,'subtype' => '電子書籍'),
  array('mainid' => 10082441,'maintype' => '単行本','subid' => 619671,'subtype' => '電子書籍'),
  array('mainid' => 10082442,'maintype' => '単行本','subid' => 620380,'subtype' => '電子書籍'),
  array('mainid' => 10082443,'maintype' => '単行本','subid' => 620381,'subtype' => '電子書籍'),
  array('mainid' => 10082444,'maintype' => '単行本','subid' => 620382,'subtype' => '電子書籍'),
  array('mainid' => 10082010,'maintype' => '単行本','subid' => 620383,'subtype' => '電子書籍'),
  array('mainid' => 10082446,'maintype' => '単行本','subid' => 621016,'subtype' => '電子書籍'),
  array('mainid' => 10082447,'maintype' => '単行本','subid' => 621019,'subtype' => '電子書籍'),
  array('mainid' => 10082013,'maintype' => '単行本','subid' => 621021,'subtype' => '電子書籍'),
  array('mainid' => 10082449,'maintype' => '単行本','subid' => 621023,'subtype' => '電子書籍'),
  array('mainid' => 10082450,'maintype' => '単行本','subid' => 621860,'subtype' => '電子書籍'),
  array('mainid' => 10082451,'maintype' => '単行本','subid' => 621862,'subtype' => '電子書籍'),
  array('mainid' => 10082452,'maintype' => '単行本','subid' => 621863,'subtype' => '電子書籍'),
  array('mainid' => 10082453,'maintype' => '単行本','subid' => 621864,'subtype' => '電子書籍'),
  array('mainid' => 10082454,'maintype' => '単行本','subid' => 621865,'subtype' => '電子書籍'),
  array('mainid' => 10082455,'maintype' => '単行本','subid' => 621872,'subtype' => '電子書籍'),
  array('mainid' => 10082456,'maintype' => '単行本','subid' => 621873,'subtype' => '電子書籍'),
  array('mainid' => 10082457,'maintype' => '単行本','subid' => 621875,'subtype' => '電子書籍'),
  array('mainid' => 10082458,'maintype' => '単行本','subid' => 621949,'subtype' => '電子書籍'),
  array('mainid' => 10082459,'maintype' => '単行本','subid' => 621950,'subtype' => '電子書籍'),
  array('mainid' => 10082460,'maintype' => '単行本','subid' => 621952,'subtype' => '電子書籍'),
  array('mainid' => 10082461,'maintype' => '単行本','subid' => 625397,'subtype' => '電子書籍'),
  array('mainid' => 10082462,'maintype' => '単行本','subid' => 625457,'subtype' => '電子書籍'),
  array('mainid' => 10082463,'maintype' => '単行本','subid' => 625466,'subtype' => '電子書籍'),
  array('mainid' => 10082464,'maintype' => '単行本','subid' => 625622,'subtype' => '電子書籍'),
  array('mainid' => 10082465,'maintype' => '単行本','subid' => 625645,'subtype' => '電子書籍'),


  array('mainid' => 10082468,'maintype' => '単行本','subid' => 627102,'subtype' => '電子書籍'),
  array('mainid' => 10082469,'maintype' => '単行本','subid' => 627116,'subtype' => '電子書籍'),
  array('mainid' => 10082470,'maintype' => '単行本','subid' => 627434,'subtype' => '電子書籍'),
  array('mainid' => 10082471,'maintype' => '単行本','subid' => 628810,'subtype' => '電子書籍'),
  array('mainid' => 10082472,'maintype' => '単行本','subid' => 628811,'subtype' => '電子書籍'),
  array('mainid' => 10082473,'maintype' => '単行本','subid' => 628812,'subtype' => '電子書籍'),
  array('mainid' => 10082474,'maintype' => '単行本','subid' => 629449,'subtype' => '電子書籍'),
  array('mainid' => 10082475,'maintype' => '単行本','subid' => 629453,'subtype' => '電子書籍'),
  array('mainid' => 10082476,'maintype' => '単行本','subid' => 630132,'subtype' => '電子書籍'),
  array('mainid' => 10082477,'maintype' => '単行本','subid' => 630133,'subtype' => '電子書籍'),
  array('mainid' => 10082478,'maintype' => '単行本','subid' => 630134,'subtype' => '電子書籍'),
  array('mainid' => 10082479,'maintype' => '単行本','subid' => 630136,'subtype' => '電子書籍'),
  array('mainid' => 10082480,'maintype' => '単行本','subid' => 631540,'subtype' => '電子書籍'),
  array('mainid' => 10082481,'maintype' => '単行本','subid' => 631743,'subtype' => '電子書籍'),
  array('mainid' => 10082482,'maintype' => '単行本','subid' => 631747,'subtype' => '電子書籍'),
  array('mainid' => 10082483,'maintype' => '単行本','subid' => 633435,'subtype' => '電子書籍'),
  array('mainid' => 10082484,'maintype' => '単行本','subid' => 633437,'subtype' => '電子書籍'),
  array('mainid' => 10082485,'maintype' => '単行本','subid' => 633438,'subtype' => '電子書籍'),
  array('mainid' => 10082486,'maintype' => '単行本','subid' => 633439,'subtype' => '電子書籍'),
  array('mainid' => 10082487,'maintype' => '単行本','subid' => 633708,'subtype' => '電子書籍'),
  array('mainid' => 10082102,'maintype' => '単行本','subid' => 635228,'subtype' => '電子書籍'),
  array('mainid' => 10082103,'maintype' => '単行本','subid' => 635230,'subtype' => '電子書籍'),
);

// ↑ メインフォーマット bookID,メインフォーマットタイプ,サブフォーマット bookID,サブフォーマットタイプ

// $publisher_id = 24;
$publisher_id = 86; // 学陽書房 pro stg
// $publisher_id = 1125; // 竹書房 pro

$debug = true;

if($debug) {
  // // Docker用
  // // 先に Postgres側を起動しておかないと IPが認識できず、アクセスできない
  // $dsn = 'pgsql:dbname=app_development;host=172.20.254.227;port=15432';
  // $db = new PDO($dsn, 'postgres', 'password');

  // STG用
  $dsn = 'pgsql:dbname=d32hupuj29g33c;host=ec2-44-206-11-200.compute-1.amazonaws.com;port=5432';
  $db = new PDO($dsn, 'rszgmnfrbqlgot', '237cbd5e1db3db80228bbf1483cd208c850e4d22bfd12c85b7e317b1cc569700');
} else {
  // 本番用
  $dsn = 'pgsql:dbname=d3uldjpkj3ctch;host=ec2-52-204-191-143.compute-1.amazonaws.com;port=5432';
  $db = new PDO($dsn, 'u79urs9of0un6s', 'p34d02ab02bf28b14e66b09bc464b4b3e75840bfa9418dba10202fbe1840f91ec');
}

$datacount = count($datalist);

ob_start();

$format_type_list = array(
  "単行本" => 1,
  "文庫" => 2,
  "新書" => 3,
  "コミック" => 4,
  "電子書籍" => 5,
  // other => 6,
);
$i = 0;
$roop = 0;
foreach ($datalist as $k => $v) {
  // 前後の空白削除
  $empty = false;
  foreach ($v as $k1 => $v1) {
    $v[$k1] = trim($v1);
    if(empty($v[$k1])) {
      // 空の値がある場合は スキップ
      $empty = true;
      break;
    }
  }
  if($empty) {
    // 空の値がある場合は スキップ
    echo "empty data exists id {$v['mainid']}<br>";
    continue;
  }

  // 書誌の存在チェック
  $sql = "select id,format_group_id,format_primary,book_format,book_format_other from books where id = '{$v['mainid']}' and publisher_id = {$publisher_id};";
  $sth = $db->query($sql);
  $mainbook = $sth->fetch(PDO::FETCH_ASSOC);
  if(empty($mainbook)) {
    // 書誌データがない場合は スキップ
    echo "not main book data id {$v['mainid']}<br>";
    continue;
  }

  $sql = "select id,format_group_id,format_primary,book_format,book_format_other from books where id = '{$v['subid']}' and publisher_id = {$publisher_id};";
  $sth = $db->query($sql);
  $subbook = $sth->fetch(PDO::FETCH_ASSOC);
  if(empty($subbook)) {
    // 書誌データがない場合は スキップ
    echo "not sub book data id {$v['subid']}<br>";
    continue;
  }

  // サブbookがフォーマット設定されていないことを確認
  if(!empty($subbook['format_group_id'])) {
    echo "sub book is already formatted id {$v['subid']}<br>";
    continue;
  }

  $format_group_id = 0;
  if(empty($mainbook['format_group_id'])) {
    // メインbookが フォーマット設定されていない場合は
    // format_groups テーブルにレコード追加
    $sql = "insert into format_groups (publisher_id,created_at,updated_at) values ({$publisher_id},now(),now())";
    if($db->exec($sql) === false) {
      echo "add format_groups error main book id {$v['mainid']}<br>";
      continue;
    }

    // 最後に追加したIDを取得する
    // https://minory.org/postgresql-returning.html
    $sql = "SELECT lastval();";
    $sth = $db->query($sql);
    $fg = $sth->fetch(PDO::FETCH_ASSOC);
    if(empty($fg['lastval'])) {
      echo "get last id error main book id {$v['mainid']}<br>";
      continue;
    }
    // format_group_id 設定
    $sql = "update books set format_group_id = {$fg['lastval']},updated_at = now() where id = {$v['mainid']}";
    if($db->exec($sql) === false) {
      echo "format_group_id set error main book id {$v['mainid']}<br>";
      continue;
    }
    $format_group_id = $fg['lastval'];
  } else {
    // main book に既にフォーマットグループが設定されている場合
    $format_group_id = $mainbook['format_group_id'];
  }
  // main bookのフォーマットタイプ 設定
  $maintypeid = 6;
  $maintype_other = 'null';
  if(array_key_exists($v['maintype'],$format_type_list)) {
    // フォーマットタイプIDを設定
    $maintypeid = $format_type_list[$v['maintype']];
  } else {
    // フォーマットタイプ その他を設定
    $maintype_other = "'" . str_replace("'","''",$v['maintype']) . "'";
  }
  $sql = "update books set book_format = {$maintypeid},book_format_other = {$maintype_other},updated_at = now() where id = {$v['mainid']}";
  if($db->exec($sql) === false) {
    echo "main book update error id {$v['mainid']}<br>";
    continue;
  }

  // sub book 設定
  $subtypeid = 6;
  $subtype_other = 'null';
  if(array_key_exists($v['subtype'],$format_type_list)) {
    // フォーマットタイプIDを設定
    $subtypeid = $format_type_list[$v['subtype']];
  } else {
    // フォーマットタイプ その他を設定
    $subtype_other = "'" . str_replace("'","''",$v['subtype']) . "'";
  }
  $sql = "update books set book_format = {$subtypeid},book_format_other = {$subtype_other},format_group_id = {$format_group_id},format_primary = false,updated_at = now() where id = {$v['subid']}";
  if($db->exec($sql) === false) {
    echo "sub book update error id {$v['subid']}<br>";
    continue;
  }

  $i++;
  $roop++;
  // if($i > 20) {
    // 20回まわったら ページ出力
    echo $roop . " / " . $datacount . " mainid:" . $v['mainid'] . "<br>";
    flush();
    ob_flush();
    $i = 0;
  // }
}
flush();
ob_flush();

ob_end_flush();

echo "end!!";
exit();
